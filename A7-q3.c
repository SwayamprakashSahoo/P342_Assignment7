//Program to solve an ODE using shooting Method

#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include "mylib.h"

void cases(double h);

void main()
{
	printf("Given ODE :\n\ty'' = y' + 1\n");
    printf("Given boundary values :\n\ty(0) = 1\n\ty(1) = 2(e-1)\n");
	
    cases(0.5);
    cases(0.2);
    cases(0.05);
    cases(0.02);
}

void cases(double h)
{
    printf("\n\nFor value of h = %lf\n", h);
    double x, u, t, y, v, e, m1, m2, m3, b, b1, b2, b3;
    int a;
    x = 0;
    u = 1;
    t = 1;
    y = 2 * (exp(1) - 1);
    printf("\nEnter the 1st guess M1: ");
    scanf("%lf", &m1);
    v = m1;
    b = y;
    b1 = shoot(u, v, x, t, h, 1);
    printf("\nB1 is %lf", b1);
    if (fabs(b1 - b) < 0.00005)
    {
        printf("\n  The value of x and respective z are:\n");
        e = shoot(u, v, x, t, h, 1);
        return(0);
    }
    else
    {
        printf("\nEnter the 2nd guess M2:");
        scanf("%lf", &m2);
        v = m2;
        b2 = shoot(u, v, x, t, h, 1);
        printf("\nB2 is %lf", b2);
    }
    if (fabs(b2 - b) < 0.00005)
    {
        printf("\n  The value of x and respective z are\n");
        e = shoot(u, v, x, t, h, 1);
        return(0);
    }
    else
    {
        printf("\n\nM2=%lf\tM1=%lf", m2, m1);
        m3 = m2 + (((m2 - m1) * (b - b2)) / (b2 - b1));
        if (b1 - b2 == 0)
            return;

        printf("\nExact value of M =%lf", m3);
        v = m3;
        b3 = shoot(u, v, x, t, h, 0);
    }
    if (fabs(b3 - b) < 0.00005)
    {
        printf("\nFor which solution is :\n");
        e = shoot(u, v, x, t, h, 1);
        return;
    }
    do
    {
        m1 = m2;
        m2 = m3;
        b1 = b2;
        b2 = b3;
        m3 = m2 + (((m2 - m1) * (b - b2)) / (b2 - b1));
        v = m3;
        b3 = shoot(u, v, x, t, h, 0);

    } while (fabs(b3 - b) < 0.00005);
    v = m3;
    e = shoot(u, v, x, t, h, 1);
}








/*********************************************OUTPUT*************************************************
Given ODE :
        y'' = y' + 1
Given boundary values :
        y(0) = 1
        y(1) = 2(e-1)


For value of h = 0.500000

Enter the 1st guess M1: -1

0.500000        1.500000
1.000000        1.500000
B1 is 1.500000
Enter the 2nd guess M2:-2

0.500000        0.851563
1.000000        -0.865784
B2 is -0.865784

M2=-2.000000    M1=-1.000000
Exact value of M =-0.181428
For which solution is :

0.500000        2.030793
1.000000        3.436564

For value of h = 0.200000

Enter the 1st guess M1: -1

0.200000        1.800000
0.400000        2.400000
0.600000        2.800000
0.800000        3.000000
1.000000        3.000000
B1 is 3.000000
Enter the 2nd guess M2:-2

0.200000        1.578600
0.400000        1.686782
0.600000        1.264676
0.800000        0.239155
1.000000        -1.479096
B2 is -1.479096

M2=-2.000000    M1=-1.000000
Exact value of M =-0.902533
For which solution is :

0.200000        1.821579
0.400000        2.469515
0.600000        2.949643
0.800000        3.269091
1.000000        3.436564

For value of h = 0.050000

Enter the 1st guess M1: -1

0.050000        1.950000
0.100000        2.850000
0.150000        3.700000
0.200000        4.500000
0.250000        5.250000
0.300000        5.950000
0.350000        6.600000
0.400000        7.200000
0.450000        7.750000
0.500000        8.250000
0.550000        8.700000
0.600000        9.100000
0.650000        9.450000
0.700000        9.750000
0.750000        10.000000
0.800000        10.200000
0.850000        10.350000
0.900000        10.450000
0.950000        10.500000
1.000000        10.500000
B1 is 10.500000
Enter the 2nd guess M2:-2

0.050000        1.898729
0.100000        2.693558
0.150000        3.381724
0.200000        3.960321
0.250000        4.426296
0.300000        4.776437
0.350000        5.007369
0.400000        5.115545
0.450000        5.097232
0.500000        4.948511
0.550000        4.665258
0.600000        4.243140
0.650000        3.677599
0.700000        2.963846
0.750000        2.096846
0.800000        1.071305
0.850000        -0.118341
0.900000        -1.477944
0.950000        -3.013654
1.000000        -4.731936
B2 is -4.731936

M2=-2.000000    M1=-1.000000
Exact value of M =-1.463725
For which solution is :

0.050000        1.926224
0.100000        2.777454
0.150000        3.552407
0.200000        4.249737
0.250000        4.868027
0.300000        5.405789
0.350000        5.861457
0.400000        6.233385
0.450000        6.519844
0.500000        6.719016
0.550000        6.828988
0.600000        6.847750
0.650000        6.773191
0.700000        6.603088
0.750000        6.335106
0.800000        5.966792
0.850000        5.495564
0.900000        4.918709
0.950000        4.233375
1.000000        3.436564

For value of h = 0.020000

Enter the 1st guess M1: -1

0.020000        1.980000
0.040000        2.940000
0.060000        3.880000
0.080000        4.800000
0.100000        5.700000
0.120000        6.580000
0.140000        7.440000
0.160000        8.280000
0.180000        9.100000
0.200000        9.900000
0.220000        10.680000
0.240000        11.440000
0.260000        12.180000
0.280000        12.900000
0.300000        13.600000
0.320000        14.280000
0.340000        14.940000
0.360000        15.580000
0.380000        16.200000
0.400000        16.800000
0.420000        17.380000
0.440000        17.940000
0.460000        18.480000
0.480000        19.000000
0.500000        19.500000
0.520000        19.980000
0.540000        20.440000
0.560000        20.880000
0.580000        21.300000
0.600000        21.700000
0.620000        22.080000
0.640000        22.440000
0.660000        22.780000
0.680000        23.100000
0.700000        23.400000
0.720000        23.680000
0.740000        23.940000
0.760000        24.180000
0.780000        24.400000
0.800000        24.600000
0.820000        24.780000
0.840000        24.940000
0.860000        25.080000
0.880000        25.200000
0.900000        25.300000
0.920000        25.380000
0.940000        25.440000
0.960000        25.480000
0.980000        25.500000
1.000000        25.500000
B1 is 25.500000
Enter the 2nd guess M2:-2

0.020000        1.959799
0.040000        2.878988
0.060000        3.757151
0.080000        4.593864
0.100000        5.388693
0.120000        6.141197
0.140000        6.850923
0.160000        7.517412
0.180000        8.140194
0.200000        8.718792
0.220000        9.252715
0.240000        9.741466
0.260000        10.184536
0.280000        10.581406
0.300000        10.931547
0.320000        11.234419
0.340000        11.489472
0.360000        11.696142
0.380000        11.853858
0.400000        11.962033
0.420000        12.020072
0.440000        12.027364
0.460000        11.983290
0.480000        11.887216
0.500000        11.738495
0.520000        11.536467
0.540000        11.280460
0.560000        10.969788
0.580000        10.603749
0.600000        10.181630
0.620000        9.702702
0.640000        9.166221
0.660000        8.571429
0.680000        7.917551
0.700000        7.203799
0.720000        6.429366
0.740000        5.593430
0.760000        4.695154
0.780000        3.733682
0.800000        2.708141
0.820000        1.617641
0.840000        0.461274
0.860000        -0.761887
0.880000        -2.052787
0.900000        -3.412390
0.920000        -4.841680
0.940000        -6.341662
0.960000        -7.913358
0.980000        -9.557814
1.000000        -11.276096
B2 is -11.276096

M2=-2.000000    M1=-1.000000
Exact value of M =-1.599940
For which solution is :

0.020000        1.967880
0.040000        2.903396
0.060000        3.806298
0.080000        4.676331
0.100000        5.513235
0.120000        6.316744
0.140000        7.086589
0.160000        7.822493
0.180000        8.524175
0.200000        9.191346
0.220000        9.823715
0.240000        10.420982
0.260000        10.982842
0.280000        11.508984
0.300000        11.999089
0.320000        12.452836
0.340000        12.869891
0.360000        13.249920
0.380000        13.592577
0.400000        13.897512
0.420000        14.164367
0.440000        14.392776
0.460000        14.582367
0.480000        14.732759
0.500000        14.843566
0.520000        14.914390
0.540000        14.944829
0.560000        14.934471
0.580000        14.882896
0.600000        14.789674
0.620000        14.654369
0.640000        14.476535
0.660000        14.255716
0.680000        13.991448
0.700000        13.683257
0.720000        13.330661
0.740000        12.933166
0.760000        12.490269
0.780000        12.001457
0.800000        11.466207
0.820000        10.883983
0.840000        10.254243
0.860000        9.576429
0.880000        8.849974
0.900000        8.074300
0.920000        7.248817
0.940000        6.372923
0.960000        5.446002
0.980000        4.467429
1.000000        3.436564
*******************************************************************************************/
